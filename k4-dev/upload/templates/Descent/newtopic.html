<form:form name="posttopic_form" id="pottopic_form" action="newtopic.php?act=posttopic" method="post" enctype="multipart/form-data">
<input type="hidden" name="forum_id" value="{$forum_id}" />
<script type="text/javascript">
// <!--

function showTable(Id) {
	var the_tr = document.getElementById(Id);
	if(the_tr.style.display == 'block')
		return the_tr.style.display = 'none';
	else
		return the_tr.style.display = 'block';
}
function swap_posticon(imgid) {
	var out = document.getElementById("display_posticon");
	var img	= document.getElementById(imgid);
	if (img) {
		out.src = img.src;
		out.alt = img.alt;
	} else {
		out.src = "tmp/upload/posticons/clear.gif";
		out.alt = "";
	}
}
function emoticon(typed) {
	var editor	= document.getElementById('messagecodex');
	editor.value += ' ' + typed;
}

<maps:if forum="forum_id" var="bbcode" method="can_add">
/****************************
 * BBCode Control front-end *
 * By Peter Goodman         *
 ****************************/
<core:import id="bbcode" file="bbcode.js" />
</maps:if>
// -->
</script>
<input type="hidden" name="forum_id" value="{$forum_id}" />
<table width="100%" cellpadding="0" cellspacing="1" border="0" class="forum_content">
	<core:block id="post_topic">
	<tr class="thead" colspan="2">
		<td colspan="2">
			<div style="float:right;" class="smalltext">
				<strong>{$L_FORUM}:</strong>
				<a href="viewforum.php?id={$forum_id}" class="smalltext" style="font-weight: normal;" title="{$forum_name}">{$forum_name}</a>
				</div>
			{$L_POSTTOPIC}
		</td>
	</tr>
	</core:block>
	<core:block id="edit_post" hidden="yes">
	<tr class="thead" colspan="2">
		<td colspan="2">{$L_EDITPOST} : <span style="font-weight: normal;">{$posttitle}</span><input type="hidden" name="post_id" value="{$post_id}" /></td>
	</tr>
	</core:block>
	<tr class="panel">
		<td colspan="2" align="center">
			
			<!-- Main Posting Inputs -->
			<div class="outset_box" align="left">
				<div class="smalltext" style="float: right;">
					{$L_LOGGEDAS} <a href="member.php?id={$user_id}" style="text-decoration: underline;">{$user_name}</a>
				</div>
				<table border="0" cellpadding="0" cellspacing="0">
					<tr>
						<td>
							<!-- Post Title -->
							<label for="{$L_POSTTITLE}" class="smalltext">{$L_POSTTITLE}</label><br />
							<input type="text" name="title" id="{$L_POSTTITLE}" value="{$posttitle}" style="width: 500px;" class="inputbox" maxlength="255" />
							<!-- / Post Title -->
						</td>
						<td valign="bottom">
							<img id="display_posticon" src="tmp/upload/posticons/clear.gif" alt="" />
						</td>
					</tr>
					<tr>
						<td>
							<br />
							<!-- Post Message -->
							<label for="messagecodex" class="smalltext">{$L_POST}</label><br />
							<if:if var="allowbbcode" eq="0">
								<textarea name="message" id="messagecodex" class="inputbox" rows="10" cols="100">{$message}</textarea>
							<if:else />
								<maps:if forum="forum_id" var="bbcode" method="can_add">
									<div id="message" style="display: none;">{$message}</div>
									<script type="text/javascript">
										bbcodex_init('message', 'message', 10, 100, 'inputbox', 'width: 500px;', 'bbcode_button');
									</script>
								<maps:else />
									<textarea name="message" id="messagecodex" class="inputbox" rows="10" cols="100">{$message}</textarea>
								</maps:if>
							</if:if>
							<!-- / Post Message -->

						</td>
						<td valign="bottom">
							<maps:if forum="forum_id" var="emoticons" method="can_add">
							<list:list id="emoticons">
							<!-- Emoticons -->
							<table border="0" cellpadding="0" cellspacing="0">
								<tr>
									<td>
										<fieldset>
											<legend>{$L_EMOTICONS}</legend>
											<table cellpadding="3" cellspacing="1" border="0" id="posticons">
												<tr>
													<list:item list="emoticons">
													<td align="center">
														<a href="javascript:emoticon('{$typed}')" title="{$description}"><img src="tmp/upload/emoticons/{$image}" alt="{$description}" border="0" /></a>
													</td>
													<list:separator list="emoticons">
														<list:alternate list="emoticons" count="{@emoticons_per_row}" remainder="{@emoticons_per_row_remainder}">
															</tr><tr>
														</list:alternate>
													</list:separator>
													</list:item>
												</tr>	
											</table>
										</fieldset>
									</td>
								</tr>
							</table>
							<!-- / Emoticons -->
							</list:list>
							</maps:if>
						</td>
					</tr>
					<maps:if forum="forum_id" var="posticons" method="can_add">
					<tr>
						<td colspan="2">
							<list:list id="posticons">
							<!-- Post Icons -->
							<table border="0" cellpadding="0" cellspacing="0" width="100%">
								<tr>
									<td>
										<fieldset>
											<legend>{$L_POSTICONS}</legend>
											<span class="smalltext">{$L_POSTICONSPOSTCHOOSE}</span>
											<label for="noicon" style="float: left;margin-top: 10px;"><input type="radio" name="posticon" id="noicon" value="-1" checked="checked" onclick="swap_posticon(null)" />&nbsp;{$L_NOICON}</label>
											<table cellpadding="3" cellspacing="1" border="0" id="posticons">
												<tr>
													<list:item list="posticons">
													<td align="center">
														<label for="pi{$id}">
															<input type="radio" name="posticon" id="pi{$id}" value="{$id}" style="float: left;padding-right: 5px;" onclick="swap_posticon('pi_{$id}')" />&nbsp;&nbsp;<img src="tmp/upload/posticons/{$image}" alt="{$description}" id="pi_{$id}" style="margin-right:15px;" />
														</label>
													</td>
													<list:separator list="posticons">
														<list:alternate list="posticons" count="7" remainder="6">
															</tr><tr>
														</list:alternate>
													</list:separator>
													</list:item>
												</tr>	
											</table>
										</fieldset>
									</td>
								</tr>
							</table>
							<!-- / Post Icons -->
							</list:list>
						</td>
					</tr>
					</maps:if>
				</table>
			</div>
			<!-- / Main Posting Inputs -->

		</td>
	</tr>
	<core:block id="post_icons" hidden="yes">
	<tr class="panel">
		<td colspan="2">
			<fieldset style="float:left; width:95%;">
			<legend><label>{$L_POSTICONS}</label></legend>
			<div align="center">
			<label for="noicon"><input type="radio" name="posticon" id="noicon" value="-1" checked="checked" onclick="swap_posticon(null)" /> {$L_NOICON}</label>&nbsp;&nbsp;&nbsp;
			<table cellpadding="3" cellspacing="1" border="0" id="posticons">
				<tr class="panel">
					<list:list id="posticons">
					<list:item list="posticons">
					<td>
						<label for="pi{$id}"><input type="radio" name="posticon" id="pi{$id}" value="{$id}" onclick="swap_posticon(pi_{$id})" /><img src="Images/{$IMG_DIR}/Icons/PostIcons/{$image}" alt="{$description}" title="{$description}" style="margin-right:10px;" id="pi_{$id}" /></label>						
					</td>
					</list:item>
					</list:list>
				</tr>	
			</table>
			</div>
			</fieldset>
		</td>
	</tr>
	</core:block>
	<tr class="tcat">
		<td align="left" colspan="2">
			<input type="submit" class="button" value="{$L_SAVE}" accesskey="s" /><input type="reset" class="button" value="{$L_RESET}" />
		</td>
	</tr>
</table>
</form:form>
<br />
<!-- Posting Code Allowances -->
<table width="100%" cellpadding="0" cellspacing="1" border="0" class="forum_content">
	<tr class="thead">
		<td colspan="2">{$L_POSTINGRULES}</td>
	</tr>
	<tr class="panel">
		<td valign="top">
			<div align="left" class="minitext">
				{$posting_code_options}
			</div>
		</td>
		<td valign="top">
			<div align="right" class="minitext">
				<table cellpadding="0" cellspacing="0" border="0">
					<tr>
						<td valign="top">
							{$forum_user_reply_options}
						</td>
						<td>&nbsp;&nbsp;</td>
						<td valign="top">
							{$forum_user_topic_options}
						</td>
					</tr>
				</table>
			</div>
		</td>
	</tr>
</table>
<!-- / Posting Code Allowances -->