CREATE TABLE k4_users (
	id			INTEGER UNSIGNED,
	name			VARCHAR(30) NOT NULL DEFAULT '',
	email			VARCHAR(255) NOT NULL DEFAULT '',
	pass			VARCHAR(32) NOT NULL DEFAULT '',
	priv_key		VARCHAR(32) NOT NULL DEFAULT '',
	created			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	login			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	seen			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	last_seen		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	perms			INTEGER UNSIGNED NOT NULL DEFAULT 2,
	invisible		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	usergroups		VARCHAR(255) NOT NULL DEFAULT '',
	ip			VARCHAR(40) NOT NULL DEFAULT '',

	PRIMARY KEY(id)
);
CREATE INDEX name ON k4_users (name);

CREATE TABLE k4_userinfo (
	user_id			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	fullname		VARCHAR(100) NOT NULL DEFAULT '',
	num_posts		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	timezone		decimal(5,2) NOT NULL DEFAULT 0,
	address			VARCHAR(255) NOT NULL DEFAULT '',
	occupation		VARCHAR(100) NOT NULL DEFAULT '',
	interests		VARCHAR(100) NOT NULL DEFAULT '',
	biography		VARCHAR(255) NOT NULL DEFAULT '',
	icq			VARCHAR(255) NOT NULL DEFAULT '',
	aim			VARCHAR(255) NOT NULL DEFAULT '',
	msn			VARCHAR(255) NOT NULL DEFAULT '',
	yahoo			VARCHAR(255) NOT NULL DEFAULT '',
	jabber			VARCHAR(255) NOT NULL DEFAULT '',
	avatar			BLOB,
	signature		VARCHAR(255) NOT NULL DEFAULT '',
	birthday		VARCHAR(10) NOT NULL DEFAULT '',
	homepage		VARCHAR(255) NOT NULL DEFAULT '',
	language		VARCHAR(20) NOT NULL DEFAULT 'english',
	styleset		VARCHAR(100) NOT NULL DEFAULT 'Descent',
	imgset			VARCHAR(100) NOT NULL DEFAULT 'Descent',
	tplset			VARCHAR(100) NOT NULL DEFAULT 'Descent',
	banned			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	topic_display		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	lastpage		VARCHAR(100) NOT NULL DEFAULT '',
	notify_pm		INTEGER DEFAULT 1 NOT NULL,
	popup_pm		INTEGER DEFAULT 0 NOT NULL,
	viewflash		INTEGER DEFAULT 1 NOT NULL,
	viewemoticons		INTEGER DEFAULT 1 NOT NULL,
	viewsigs		INTEGER DEFAULT 1 NOT NULL,
	viewavatars		INTEGER DEFAULT 1 NOT NULL,
	viewcensors		INTEGER DEFAULT 1 NOT NULL,
	attachsig		INTEGER DEFAULT 1 NOT NULL
);
CREATE INDEX user_id ON k4_userinfo (user_id);

CREATE TABLE k4_sessions (
	id			VARCHAR(32) NOT NULL DEFAULT '',
	seen			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	name			VARCHAR(30) NOT NULL DEFAULT '',
	user_id			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	user_agent		VARCHAR(100) NOT NULL DEFAULT '',
	data			TEXT,

	location_file		VARCHAR(25) NOT NULL DEFAULT '',
	location_act		VARCHAR(25) NOT NULL DEFAULT '',
	location_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,

	PRIMARY KEY(id)
);

CREATE TABLE k4_settinggroup (
	id			INTEGER UNSIGNED,
	title			VARCHAR(100) NOT NULL,
	displayorder		INTEGER UNSIGNED NOT NULL DEFAULT 0,

	PRIMARY KEY (id)
);
CREATE TABLE k4_setting (
	id			INTEGER UNSIGNED,
	settinggroupid		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	varname			VARCHAR(100) NOT NULL,
	value			MEDIUMTEXT NOT NULL,
	optioncode		CHAR(20) NOT NULL DEFAULT 'text',
	displayorder		INTEGER UNSIGNED NOT NULL DEFAULT 0,

	PRIMARY KEY (id)
);
CREATE INDEX varname ON k4_setting (varname);

CREATE TABLE k4_styles (
	id			INTEGER UNSIGNED,
	name			VARCHAR(100) NOT NULL DEFAULT '',
	description		VARCHAR(255) NOT NULL DEFAULT '',

	PRIMARY KEY(id)
);
CREATE TABLE k4_css (
	id			INTEGER UNSIGNED,
	style_id		INTEGER UNSIGNED NOT NULL DEFAULT 1,
	name			VARCHAR(100) NOT NULL DEFAULT '',
	properties		TEXT,
	description		VARCHAR(255) NOT NULL DEFAULT '',
	prev_name		VARCHAR(100) NOT NULL DEFAULT '',
	prev_properties		TEXT,

	PRIMARY KEY(id)
);
CREATE TABLE k4_information (
	id			INTEGER UNSIGNED,
	parent_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	row_left		INTEGER UNSIGNED NOT NULL DEFAULT 1,
	row_right		INTEGER UNSIGNED NOT NULL DEFAULT 2,
	row_type		INTEGER UNSIGNED NOT NULL DEFAULT 1,
	row_level		INTEGER UNSIGNED NOT NULL DEFAULT 1,
	row_order		INTEGER UNSIGNED NOT NULL DEFAULT 1,
	name			VARCHAR(255) NOT NULL DEFAULT '',
	created			INTEGER UNSIGNED NOT NULL DEFAULT 0,

	PRIMARY KEY(id)
);
CREATE INDEX row_left ON k4_information (row_left);
CREATE INDEX row_right ON k4_information (row_right);

CREATE TABLE k4_categories (
	category_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	description		TEXT,
	suspended		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	archive			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	moderating_groups	TEXT,
	moderating_users	TEXT
);
CREATE INDEX category_id ON k4_categories (category_id);

CREATE TABLE k4_forums (
	forum_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	category_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	description		TEXT,
	archive			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	subforums		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	
	is_forum		INTEGER UNSIGNED NOT NULL DEFAULT 1,
	is_tracker		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	is_link			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	link_redirects		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	link_show_redirects	INTEGER UNSIGNED NOT NULL DEFAULT 1,
	link_href		VARCHAR(255) NOT NULL DEFAULT '',
	
	moderating_groups	VARCHAR(255) NOT NULL DEFAULT '',
	moderating_users	VARCHAR(255) NOT NULL DEFAULT '',

	pass			VARCHAR(32) NOT NULL DEFAULT '',
	
	topics			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	replies			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	posts			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	
	topic_posticon		VARCHAR(100) NOT NULL DEFAULT '',
	topic_created		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	topic_name		VARCHAR(32) NOT NULL DEFAULT '',
	topic_uname		VARCHAR(16) NOT NULL DEFAULT '',
	topic_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	topic_uid		INTEGER UNSIGNED NOT NULL DEFAULT 0,

	post_posticon		VARCHAR(100) NOT NULL DEFAULT '',
	post_created		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	post_name		VARCHAR(32) NOT NULL DEFAULT '',
	post_uname		VARCHAR(16) NOT NULL DEFAULT '',
	post_id			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	post_uid		INTEGER UNSIGNED NOT NULL DEFAULT 0,

	topicsperpage		INTEGER UNSIGNED NOT NULL DEFAULT 30,
	postsperpage		INTEGER UNSIGNED NOT NULL DEFAULT 9,
	maxpolloptions		INTEGER UNSIGNED NOT NULL DEFAULT 10,
	defaultlang		VARCHAR(100) NOT NULL DEFAULT 'english',
	defaultstyle		VARCHAR(100) NOT NULL DEFAULT 'Descent',

	prune_auto		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	prune_frequency		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	prune_post_age		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	prune_post_viewed_age	INTEGER UNSIGNED NOT NULL DEFAULT 0,
	prune_old_polls		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	prune_announcements	INTEGER UNSIGNED NOT NULL DEFAULT 0,
	prune_stickies		INTEGER UNSIGNED NOT NULL DEFAULT 0,

	num_viewing		INTEGER UNSIGNED NOT NULL DEFAULT 0,

	forum_rules		TEXT
);
CREATE INDEX forum_id ON k4_forums (forum_id);

CREATE TABLE k4_topics (
	topic_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	forum_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	category_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,

	is_draft		INTEGER UNSIGNED NOT NULL DEFAULT 0,

	edited_time		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	edited_username		VARCHAR(16) NOT NULL DEFAULT '',
	edited_userid		INTEGER UNSIGNED NOT NULL DEFAULT 0,

	ratings_sum		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	ratings_num		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	rating			INTEGER UNSIGNED NOT NULL DEFAULT 0,

	disable_html		INTEGER UNSIGNED NOT NULL DEFAULT 1,
	disable_bbcode		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	disable_emoticons	INTEGER UNSIGNED NOT NULL DEFAULT 0,
	disable_sig		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	disable_areply		INTEGER UNSIGNED NOT NULL DEFAULT 1,
	disable_aurls		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	
	description		VARCHAR(255) NOT NULL DEFAULT '',
	body_text		TEXT,
	posticon		VARCHAR(100) NOT NULL DEFAULT '',
	topic_type		INTEGER UNSIGNED NOT NULL DEFAULT 1,
	topic_expire		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	topic_locked		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	
	poster_name		VARCHAR(16) NOT NULL DEFAULT '',
	poster_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	poster_ip		VARCHAR(40) NOT NULL DEFAULT '',
	
	reply_time		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	reply_uname		VARCHAR(16) NOT NULL DEFAULT '',
	reply_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	reply_uid		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	
	poll			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	poll_question		VARCHAR(255) NOT NULL DEFAULT '',
	poll_id			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	poll_votes		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	
	views			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	last_viewed		INTEGER UNSIGNED NOT NULL DEFAULT 0
);
CREATE INDEX topic_id ON k4_topics (topic_id);

CREATE TABLE k4_replies (
	reply_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	topic_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	forum_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	category_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	
	is_draft		INTEGER UNSIGNED NOT NULL DEFAULT 0,

	body_text		TEXT,
	poster_name		VARCHAR(16) NOT NULL DEFAULT '',
	poster_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	poster_ip		VARCHAR(40) NOT NULL DEFAULT '',

	edited_time		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	edited_username		VARCHAR(16) NOT NULL DEFAULT '',
	edited_userid		INTEGER UNSIGNED NOT NULL DEFAULT 0,

	disable_html		INTEGER UNSIGNED NOT NULL DEFAULT 1,
	disable_bbcode		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	disable_emoticons	INTEGER UNSIGNED NOT NULL DEFAULT 0,
	disable_sig		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	disable_areply		INTEGER UNSIGNED NOT NULL DEFAULT 1,
	disable_aurls		INTEGER UNSIGNED NOT NULL DEFAULT 0,

	posticon		VARCHAR(100) NOT NULL DEFAULT ''
);
CREATE INDEX reply_id ON k4_replies (reply_id);

CREATE TABLE k4_polloptions (
	id			INTEGER UNSIGNED,
	topic_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	name			VARCHAR(255) NOT NULL DEFAULT '',
	color	 		VARCHAR(24) NOT NULL DEFAULT '',
	
	PRIMARY KEY(id)	
);
CREATE TABLE k4_pollvotes (
	id			INTEGER UNSIGNED,
	topic_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	option_id 		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	user_id 		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	user_name		VARCHAR(16) NOT NULL DEFAULT '',
	
	PRIMARY KEY(id)	
);
CREATE TABLE k4_ratings (
	user_id			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	topic_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	rating			INTEGER UNSIGNED NOT NULL DEFAULT 0
);
CREATE TABLE k4_maps (
	id			INTEGER UNSIGNED,
	row_left		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	row_right		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	row_level		INTEGER UNSIGNED NOT NULL DEFAULT 1,
	name			VARCHAR(255) NOT NULL DEFAULT '',
	varname			CHAR(30) NOT NULL DEFAULT '',
	value			VARCHAR(255) NOT NULL DEFAULT '',
	
	is_global		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	category_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	forum_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	user_id			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	group_id		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	
	can_view		INTEGER UNSIGNED NOT NULL DEFAULT 1,
	can_add			INTEGER UNSIGNED NOT NULL DEFAULT 2,
	can_edit		INTEGER UNSIGNED NOT NULL DEFAULT 2,
	can_del			INTEGER UNSIGNED NOT NULL DEFAULT 7,
	
	inherit			INTEGER UNSIGNED NOT NULL DEFAULT 1,

	PRIMARY KEY(id)
);
CREATE INDEX row_left2 ON k4_maps(row_left);
CREATE INDEX row_right2 ON k4_maps(row_right);

CREATE TABLE k4_datastore (
	varname			CHAR(30) NOT NULL DEFAULT '',
	data			TEXT,

	PRIMARY KEY(varname)
);

CREATE TABLE k4_posticons (
	id			INTEGER UNSIGNED,
	description		VARCHAR(100) NOT NULL DEFAULT '',
	image			VARCHAR(100) NOT NULL DEFAULT '',

	PRIMARY KEY(id)
);

CREATE TABLE k4_emoticons (
	id 			INTEGER UNSIGNED,
	typed 			VARCHAR(32) NOT NULL DEFAULT '',
	description		VARCHAR(50) NOT NULL DEFAULT '',
	image 			VARCHAR(128) NOT NULL DEFAULT '',
	clickable 		INTEGER UNSIGNED NOT NULL DEFAULT 0,
	
	PRIMARY KEY(id)
);

CREATE TABLE k4_usergroups (
	id			INTEGER UNSIGNED,
	name			VARCHAR(255) NOT NULL DEFAULT '',
	nicename		VARCHAR(255) NOT NULL DEFAULT '',
	description		VARCHAR(255) NOT NULL DEFAULT '',
	mod_name		VARCHAR(16) NOT NULL DEFAULT '',
	mod_id			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	created			INTEGER UNSIGNED NOT NULL DEFAULT 0,
	min_perm		INTEGER UNSIGNED NOT NULL DEFAULT 3,
	max_perm		INTEGER UNSIGNED NOT NULL DEFAULT 3,
	display_legend		INTEGER UNSIGNED NOT NULL DEFAULT 1,

	custom_map_set		INTEGER UNSIGNED NOT NULL DEFAULT 0,

	color			VARCHAR(6) NOT NULL DEFAULT '',
	avatar			VARCHAR(100) NOT NULL DEFAULT '',

	PRIMARY KEY(id)
);
CREATE INDEX name2 ON k4_usergroups(name);